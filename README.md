# WebRTC FastAPI Video Chat

A real-time peer-to-peer video chat application built with FastAPI and WebRTC.

## Features

- ğŸ¥ Real-time video and audio communication
- ğŸ”’ Room-based private conversations
- ğŸŒ WebSocket signaling server
- ğŸ“± Responsive design
- ğŸ›ï¸ Media controls (mute/unmute, video on/off)
- ğŸ‘¥ Multiple participants support
- ğŸ³ Docker support

## Quick Start with Docker

### Prerequisites

- Docker and Docker Compose installed
- A webcam and microphone
- Modern web browser

### Run the Application

```bash
# Build and start
docker-compose up -d

# View logs
docker-compose logs -f

# Stop
docker-compose down
```

Access: http://localhost:8000 (or see [Access from Other Devices](#access-from-other-devices))

## Manual Setup (without Docker)

### 1. Create Virtual Environment

```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### 2. Install Dependencies

```bash
pip install -r requirements.txt
```

### 3. Run the Application

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## Usage

1. Open http://localhost:8000 in your browser
2. Allow camera and microphone permissions
3. Enter a room name
4. Click "Join Room"
5. Share the room name with others
6. Start video chatting!

## Access from Other Devices

WebRTC permissions require a **secure context** (HTTPS or localhost). When you visit `http://<your-ip>:8000` from another machine, browsers block camera/mic access. Use one of the following approaches.


### Option A: Secure Tunnel with ngrok

If you prefer not to manage certificates, you can proxy the app through an HTTPS tunnel:

```bash
# Terminal 1
run application

# Terminal 2 (requires an ngrok account and auth token)
ngrok http 8000
```

Use the `https://` forwarding URL generated by ngrok from any device. Camera/mic prompts work because ngrok terminates TLS for you.

## Testing Locally

Open two browser tabs:
- Tab 1: Enter room "test-room" and join
- Tab 2: Enter same room "test-room" and join
- Both tabs should connect and show video

## Docker Commands

```bash
# Build
docker-compose build

# Start
docker-compose up -d

# Stop
docker-compose down

# View logs
docker-compose logs -f

# Restart
docker-compose restart

# Remove everything
docker-compose down -v
```

## Project Structure

```
webrtc-fastapi/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI app
â”‚   â”œâ”€â”€ models.py            # Data models
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â””â”€â”€ webrtc.py        # WebSocket endpoints
â”‚   â”œâ”€â”€ services/
â”‚   â””â”€â”€ static/
â”‚       â”œâ”€â”€ css/
â”‚       â”‚   â””â”€â”€ style.css
â”‚       â”œâ”€â”€ js/
â”‚       â”‚   â””â”€â”€ webrtc.js
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## Configuration

Edit `.env` file:

```
STUN_SERVER=stun:stun.l.google.com:19302
HOST=0.0.0.0
PORT=8000
```

## Troubleshooting

### Camera not working
- Check browser permissions
- Use HTTPS (`mkcert` or `ngrok` when testing off-device)
- Try different browser

### Port already in use
```bash
# Use different port
docker-compose up -d -e PORT=8001
```

### Connection failed
- Ensure both users in same room
- Check firewall settings
- View logs: `docker-compose logs -f`

## Production Deployment

For production use:
1. Use HTTPS (WebRTC requires secure context)
2. Add TURN servers for NAT traversal
3. Implement authentication
4. Set up monitoring

## License

MIT License

## Support

For issues, please check the logs and browser console (F12).


build:
	docker-compose build

up:
	docker-compose up -d
	@echo "âœ… Application started at http://localhost:8000"

dev:
	docker-compose up

down:
	docker-compose down

restart:
	docker-compose restart

logs:
	docker-compose logs -f

clean:
	docker-compose down -v
	docker system prune -f

shell:
	docker-compose exec webrtc-app /bin/bash
